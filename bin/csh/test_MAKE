#!/bin/csh -f

########
# make test
########
\rm -f $TMP/test.c $TMP/test.o $TMP/test.so

echo "#include <stdio.h>" > $TMP/test.c
echo 'int main(int argc,char ** argv){printf("hello world\n");}' >> $TMP/test.c

echo "testing MAKE from $MAKES ..." >>& /dev/stderr
@ i = 1
set STATUS = 1
while ( $i <= $#MAKES)
  set MAKE  = "$MAKES[$i]"
  echo $MAKE >>& /dev/stderr
  ${MAKE} "CC=$CC $OPT $CFLAGS_" $TMP/test >>& /dev/stderr
  if ( $status == 0 ) then
    set STATUS = 0
    break;
  endif
  @ i++
end

echo "** MAKE : $MAKE"

if ( $STATUS != 0) then
  echo "make test failed for $MAKES"
  exit 1;
endif
\rm -f $TMP/test.c $TMP/test.o $TMP/test.so $TMP/test


