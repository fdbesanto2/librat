#! /bin/sh
# Run this file to recreate the current configuration.

SHELL=${CONFIG_SHELL-/bin/sh}
export SHELL

# run a test over a loop
# and return the first that works
# eg
# if test_cmd which "lss ls"; then LS=$retval; else echo "error setting LS"; fi
test_cmd () {
  cmd=$1
  args=$2
  for arg in $args
  do
    $cmd $arg > /dev/null 2>&1
    if [ $? -eq 0 ]; then
      retval=$arg
      return 0
    fi
  done
  return 1
}

CCS=("gcc" "cc")
CFLAGSS=("-I." "-fPIC")
DYNS=("ld -G" "libtool  -L.. -lc -dynamic -undefined dynamic_lookup")
MAKES=("gmake" "make")
OPTS=("-g")

# specify a temporary directory
set TMP = /tmp

ARCH=$(uname -m)
HERE=$(pwd)
BPMS=${BPMS-$HERE}

# fixers
q='\/'
BPMS_=$(echo $BPMS | sed 's/\//Qq/g')
# initialise makefile
sed < $BPMS/src/Makefile.in 's/@BPMS@/'$BPMS_'/' | sed 's/Qq/'$q'/g' | sed 's/@ARCH@/'$ARCH'/' > $BPMS/src/makefile

mkdir -p bin/${ARCH}
PATH=".:bin:bin/${ARCH}:${PATH}"

##################
# $CC
##################
if test_cmd which $CCS; then CC=$retval; else echo "error setting CC";exit 1; fi



